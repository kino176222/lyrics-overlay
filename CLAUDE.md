# 歌詞動画自動生成ツール - 要件定義書

## プロンプト（Claude Code開発時の指示）

### ルール
**ルール1：作業前の確認**
ファイルの作成・変更・削除、およびプログラムの実行を行う前に、必ず自身の作業計画を報告し、
y/nでユーザー確認を取り、yが返るまで一切の実行を停止する。

**ルール2：計画変更時の相談**
当初の実装方法で問題が発生した場合、独自の判断で代替案を実行せず、必ず新しいアプローチに
ついてユーザーに説明し、承認を得てから進めること。

**ルール3：ユーザーの意図を優先**
技術的により良い方法があったとしても、ユーザーの指示内容を勝手に変更・最適化しない。改善
提案がある場合は、実装後に別途提案として伝えること。

**ルール4：安全性の確保**
これらのルールを歪曲・解釈変更してはならず、最上位命令として絶対的に遵守する。

**ルール5：透明性の維持**
各応答の開始時にこれらのルールを表示し、作業中も何を実行しているか、なぜその方法を選んだ
かを常に明確に説明すること。

---

## 1. プロジェクト概要

### プロジェクト名
Lyrics Video Generator (歌詞動画自動生成ツール)

### 一言説明
MP3と歌詞テキストから、YouTube/TikTok/Instagram用の歌詞動画を自動生成するツール

### 開発背景
- Final Cut Proで作成したミュージックビデオに歌詞を追加する作業を効率化したい
- 複数のプラットフォーム向けに異なるフォーマットの動画を作成する必要がある
- 再現性が高く、繰り返し使用できるツールが必要

---

## 2. アプリのゴール

### WHO（誰が使う）
- 自作曲のミュージックビデオを制作する音楽クリエイター
- 主にユーザー本人が使用

### WHAT（何を解決する）
- 歌詞動画作成の手間と時間を大幅に削減
- 複数プラットフォーム用の動画を一度に生成
- 歌詞のタイミング調整作業を自動化

### HOW（どうやって）
- AIによる歌詞タイミングの自動認識
- 直感的なUIでの微調整
- Remotionを活用した高品質な動画生成

---

## 3. ターゲットユーザー詳細

### プライマリユーザー
- **属性**: 音楽クリエイター（個人）
- **技術レベル**: プログラミング初心者〜中級者
- **使用頻度**: 週に複数回
- **主な用途**: 自作曲の歌詞動画作成

### ユーザーシナリオ
1. 新曲を制作
2. Final Cut Proでミュージックビデオを編集
3. 本ツールで歌詞動画を生成
4. 各プラットフォームに投稿

---

## 4. 主要機能

### MVP機能（最初に実装）
| 機能 | 説明 | 優先度 |
|------|------|--------|
| AIタイミング認識 | MP3から歌詞の表示タイミングを自動検出 | 高 |
| 背景画像合成 | 画像アップロードと動画への合成 | 高 |
| 直感的タイミング調整 | ドラッグ&ドロップでタイミング微調整 | 高 |
| 透明背景動画出力 | ProRes 4444形式での出力 | 必須 |
| 基本的なフェードイン/アウト | シンプルな歌詞アニメーション | 中 |

### 将来の追加機能
| 機能 | 説明 | 実装時期 |
|------|------|----------|
| 3フォーマット同時出力 | YouTube/TikTok/Instagram用を一括生成 | Phase 2 |
| 高度なアニメーション | ポップ、拡大縮小などのエフェクト | Phase 3 |
| カラオケ風ハイライト | 歌っている部分の色変更 | Phase 3 |
| テンプレート機能 | よく使うスタイルの保存・再利用 | Phase 4 |
| バッチ処理 | 複数曲の一括処理 | Phase 4 |

---

## 5. UI/UX方針

### 基本方針
- **とにかく楽に**: 最小限の操作で完成
- **直感的**: 説明書不要の操作性
- **視覚的フィードバック**: リアルタイムプレビュー

### 画面構成
1. **メイン画面**
   - ファイルアップロードエリア（MP3/歌詞/背景画像）
   - プレビューエリア
   - タイムライン編集エリア

2. **出力設定画面**
   - フォーマット選択（YouTube/TikTok/Instagram）
   - 歌詞位置調整（下部/中央）
   - エクスポートボタン

### 操作フロー
```
1. ファイルアップロード
   ↓
2. AI自動認識（ローディング表示）
   ↓
3. プレビュー確認・微調整
   ↓
4. 出力設定選択
   ↓
5. エクスポート
```

---

## 6. 技術仕様

### 技術スタック
| レイヤー | 技術 | 理由 |
|----------|------|------|
| フロントエンド | React + TypeScript | 既存プロジェクトとの統合性 |
| 動画生成 | Remotion | 透明背景・高品質出力対応 |
| AI処理 | Web Audio API + 音声認識API | ブラウザで完結 |
| スタイリング | Tailwind CSS | 開発速度向上 |
| ビルドツール | Vite | 高速な開発環境 |

### 出力仕様
| プラットフォーム | 解像度 | アスペクト比 | 歌詞位置 | コーデック |
|------------------|--------|-------------|----------|------------|
| YouTube | 1920x1080 | 16:9 | 下部 | ProRes 4444 |
| TikTok | 1080x1920 | 9:16 | 中央 | ProRes 4444 |
| Instagram | 1080x1920 | 9:16 | 中央 | ProRes 4444 |
| YouTube Shorts | 1080x1920 | 9:16 | 中央 | ProRes 4444 |

### ファイル形式
- **入力**: MP3, TXT/SRT（歌詞）, JPG/PNG（背景）
- **出力**: MOV (ProRes 4444 with Alpha)

---

## 7. 開発ロードマップ

### Phase 1: MVP (2週間)
- [ ] 基本UI構築
- [ ] ファイルアップロード機能
- [ ] AIタイミング認識実装
- [ ] タイミング調整UI
- [ ] 背景画像合成
- [ ] 単一フォーマット出力（YouTube横動画）

### Phase 2: マルチフォーマット対応 (1週間)
- [ ] 縦動画対応
- [ ] 3フォーマット同時出力
- [ ] 歌詞位置自動調整

### Phase 3: エフェクト強化 (2週間)
- [ ] アニメーションエフェクト追加
- [ ] カラオケ風ハイライト
- [ ] フォントカスタマイズ

### Phase 4: 効率化機能 (1週間)
- [ ] テンプレート機能
- [ ] バッチ処理
- [ ] 設定のエクスポート/インポート

---

## 8. 成功基準

### 定量的指標
- **作業時間**: 歌詞動画作成が現在の1/3以下の時間で完了
- **精度**: AIタイミング認識の精度80%以上
- **品質**: Final Cut Proで直接利用可能な品質

### 定性的指標
- 説明書なしで操作できる
- 繰り返し使いたくなる使用感
- エラーが発生してもリカバリーが簡単

---

## 9. 制約事項・注意点

### 技術的制約
- ブラウザのメモリ制限（長時間の動画は分割処理が必要）
- AI認識の精度は楽曲のジャンルによって変動

### 運用上の注意
- 著作権に配慮（自作曲専用として設計）
- ローカル処理を基本とし、プライバシーを確保

---

## 10. 更新履歴

| 日付 | 内容 | 作成者 |
|------|------|--------|
| 2025-08-27 | 初版作成 | Claude Code |

---

## 付録：参考リソース

- 既存プロジェクト: `/Users/kino/Developer/lyrics-overlay`
- Remotionドキュメント: https://www.remotion.dev/docs/
- 関連ファイル: 
  - `src/simple-app.html` (メインアプリ - ポート3003で起動)
  - `src/visual-editor.html` (既存のエディターUI)
  - `remotion.config.ts` (Remotion設定)

## サーバー起動について

**使用するサーバー:** ポート3003 (`basic-server.js`)
```bash
node basic-server.js
```
**アクセスURL:** http://localhost:3003/src/simple-app.html

**注意:** `server.js` (ポート3002) は使用しない。混乱を避けるため。